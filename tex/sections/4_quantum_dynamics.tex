\chapter{Dynamics of Quantum Systems}
This is a chapter to write notes on the quantum dynamics of a system.
\begin{itemize}
    \item We will simply start by having the wave equation whose dynamics follow the schödinger equation. Maybe add the interaction picture? 
    \item Generalize the concept to include the density matrix formalism. This  is need to take care of decay and interaction with the environment. Important partial trace etc.
\end{itemize}
In quantum mechanics, we consider some configuration of the system as a state, $\ket{\psi}$. This can represent a wave-function in an continuous space or be discretized. The spin of an electron follows the SU(2)-symmetry and can be represented by a two-component, complex vector called a spinor.  

\section{Density Matrix Formalism}
\newthought{Basing this part on  \cite{manzano_short_2020}}\\ 
Typically in Quantum Mechanics, a state of the system is represented by at state vector $\ket{\psi}$. Which could be in a superposition of multiple states \footnote{Which together is a basis. So {$\ket{\psi_i}$} has to be mutually orthonormal. It is also possible to have an overcomplete set, but more on that, when we talk about coherent states.} = $\ket{\psi} = \sum_i c_i\ket{\psi_i}$, where $c_i$ is the complex coefficient and the state is normalized such that $\sum |c_i|^2 = 1$. While this is a great formalism, when you have knowledge about the entire system, it is not great at handling interactions with an unknown environment. 
\\
In the density matrix formalism, we would represent a single state of a quantum system, not as a vector, but a matrix given by:
\begin{equation}
    \rho = \sum_i p_i \ket{i}\bra{i}
\end{equation}
where $p_i = |c_i|^2$ is the probability of finding the state $\ket{i}$ on measurement. With this definition, one can be convinced that:
\begin{align}
    \Tr{\rho} &= 1 \\
    p_i &\geq 0
\end{align}
Now, if we have single state, for example the ground state $\ket{\psi} = \ket{0}$. We would have $p_0 = 1, p_i = 0, \text{for } i \neq 0$. This is called a pure state, and an easy check if the state is pure, is to trace the square of the density matrix:
\begin{equation}
    \Tr{\rho_{pure}^2} = 1
\end{equation}

\textbf{Fill in with proper transition...}

While the pure states can easily be presented in the density matrix formalism. It gets more interesting, when we include the off-diagonal elements. If we were to have two coupled two level systems. We can have the entangled states\footnote{The $\otimes$ references to the product state of two Hilbert spaces: $\mathcal{H}^2 \otimes \mathcal{H}^2$. Sometimes the $\otimes$ will be omitted and the state $\ket{1 1}$ will represent $\ket{1} \otimes \ket{1}$.}:

\begin{equation}
    \ket{\phi_+} = \fracsqrttwo(\ket{0}\otimes \ket{0} + \ket{1}\otimes\ket{1})
\end{equation}

Which in density matrix formalism will be:
\begin{equation}
    \rho_{\phi+} = 
    \begin{pmatrix}
        \frac{1}{2} & 0 & 0 & \frac{1}{2} \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
        \frac{1}{2} & 0 & 0 & \frac{1}{2}
    \end{pmatrix}
\end{equation}
It can be seen that we now acquire non-diagonal terms. These are called coherences since they refer to the entanglement for the two states.  But this matrix is different from: 
\begin{equation}
    \rho = 
    \begin{pmatrix}
        \frac{1}{2} & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & \frac{1}{2}
    \end{pmatrix}
\end{equation}
where the coherences are 0. Thus this is not an entangled superposition, but rather mean that the in an ensemble of this state, half will be prepared in $\ket{00}$ and the other half in $\ket{11}$. \marginnote{This fact can not be represented in the bra-ket notation that we are used to, and here lies the true power of the density matrix formalism: we quantify entanglement versus a fraction of populations.}
In general, we write the full density matrix as:
\begin{equation}
    \rho = \sum_{ij} \rho_{i,j} \ket{i}\bra{j}
\end{equation}

\subsection{Interactions with the environment}
The properties of the of the density matrix allows us describe interaction with the environment. Start with considering the product state of two systems:
\begin{equation}
    \rho = \rho_1 \otimes \rho_2
\end{equation}
but we have no knowledge of the second system\footnote{Could be the environment while the first system is our lab.}. Now if a measurement is done in the second system, the whole system will with probability $p_i = \rho_{2, ii}$ collapse to $\ket{i}\bra{i}$ state. For this reason, we can find the leftover state in system 1 by tracing over the elements in $\rho_2$. This is called a "partial trace" or "tracing out system 2". Mathematically we can write it as:
\begin{align}
    \Tr_2 (\rho_1 \otimes \rho_2) &= \Tr_2 \left(\sum_{ijkl} \rho_{ij}\rho_{kl} \ket{i}\bra{j} \otimes \ket{k}\bra{l}\right) \nonumber \\
    &= \sum_{ij} \rho_{ij} \ket{i}\bra{j} \sum_k \rho_{kk} 
\end{align}
\textbf{CHECK THIS! It does not seem completely right.} \\


\textbf{Probably don't do entanglement above. Just show superpositions. }

In the two two level systems, tracing out the second one would give us the density matrix for the first one:
\begin{equation}
    \Tr_2 \left(\ket{\phi_+}\bra{\phi_+}\right) = \begin{pmatrix}
        \frac12 & 0 \\
        0       & \frac12
    \end{pmatrix}
\end{equation}
Meaning that half of our ensemble will be in $\ket{0}$ and the other half in $\ket{1}$.

\subsection{Other Useful Things:}
One could also show, that:
\begin{itemize}
    \item $\expval{O} = \Tr{O\rho}$
    \item entagnled = unseperable
    \item basis-change
\end{itemize}

\subsection{Quantum Maps}
Allowing for loss of entanglement information in a quantum process allows us to relax the conditions of a quantum map. A mapping of a density matrix simply takes a density matrix and maps into another one:
\begin{equation}
    \Lambda(\rho) \to \rho'
\end{equation}
For it to have the desired physical properties, we want it to be a complete positive (CP) map, such that $\rho_{ii} \geq 0$ for all $i$. This requirement ensures that a map can not map a density matrix to something with negative probabilities. A CP map can be shown to have a representation of the type: \cite{greenbaum_introduction_2015}:
\begin{equation}\
    \Lambda(\rho) = \sum_\alpha K_\alpha\rho K_\alpha^\dagger
\end{equation}
where $K_\alpha$ is an operator in our Hilbert space of interest\footnote{Which does not have to be Hermitian, Unitary or invertible.}. This representation is called the Kraus representation and $K_\alpha$ are called the Kraus operators. A further requirement for mapping density matrices to density matrices is that $\Tr{\rho} = \Tr{\rho'} = 1$. Thus the second requirement to a mapping is that it is trace preserving (TP). This is fulfilled if\marginnote{This is found by using sum-rules and the preservence of trace under circular permutation of the operators.}:
\begin{equation}
    \sum_\alpha K_\alpha^\dagger K_\alpha = \mathbb{1}
\end{equation}
Thus a physical quantum map is mathematically said to be a CPTP (complete positive trace preserving) map.  

\section{Time Evolution of Density Matrices}
The time-evolution of a single quantum state follows the schödinger equation: $i\partial_t\ket{\psi(t)} = H\ket{\psi(t)}$. Which can be solve with the time evolution operator $\unitary(t) = \exp{-iHt}$ to get $\ket{\psi(t)} = \unitary(t)\ket{\psi(0)}$. With this fact, the time dependence of a density matrix can easily be found as:
\begin{align}
    \rho(t) &= \sum_{ij} \ket{\psi_i(t)}\bra{\psi_j(t)} = \sum_{ij} \unitary(t) \ket{\psi_i(0)}\bra{\psi_j(0)} \unitary^\dagger(t) \nonumber \\
    &= \unitary(t) \rho(0) \unitary^\dagger(t)
\end{align}
And the derivative:
\begin{align}
    \partial_t \rho(t) &= (\partial_t \unitary(t)) \rho(0)\unitary^\dagger(t) + \unitary(t)\rho(0)(\partial_t \unitary^\dagger) \nonumber \\
    &= -iH \rho(t) +i \rho(t) H \nonumber \\
    &= - i \comm{H}{\rho(t)}
\end{align}

\subsection{Lindbladian / Master Equation}
\newthought{Based on (Preskill Lecture Notes chap 3). More argumentation is probably required to satisfye the Markovian approximation}\\
In the above, we have been looking at the scrödinger equation, where we consider a closed system with no loss of information/entanglement. For this reason the time evolution operator is fully unitary and invertable. However, a mapping of density matrices are more flexible and if we can relax the unitary mapping to a CPTP map, we can obtain a more general time evolution. \marginnote{Here the unitary word is used loosely. What I refer to is that the pureness is not conserved, so we don't have to conserve $\Tr{\rho^2}$, which would be conserved under unitary transformations. This would be the type: $\unitary \rho = U \rho U^\dagger$ (without the sum)} \\
In our case, we consider a system which can interact with an environment. We now assume, that the time scale in which information exits our system to the environment \textbf{Information disappears faster than it can reenter.}. This means that the history of the state is neglible for the time derivative and we only need to consider the current density matrix. This gives us a markovian approximation for our time-evolution:
\begin{equation}
    \rho(t + dt) = \Lambda[\rho(t)]
\end{equation}
Expanding this map to first order gives us:
\begin{equation}
    \Lambda = \identity + dt \lindbladian
\end{equation}
Applying this map and cosidering linear terms of $dt$ we find:
\begin{equation}
    \dot{\rho}(t) = \lindbladian [\rho(t)]
\end{equation}
Where the map $\lindbladian$ is called the Lindbladian. \marginnote{Like the Hamiltonian we can solve this system by applying this operation many times: $\rho(t) = \lim_{n\to \infty} (\identity + \lindbladian t/n)^n\rho(t =0 )$ which can be written as an exponential: $\exp(\lindbladian t)\rho(t = 0)$} To find the lindbladian, we write out the map $\Lambda$ in the Krauss representation:
\begin{equation}\label{eq:mapping_comparison}
    \rho(t + dt) = \Lambda[\rho(t)] = \rho(t) + dt \lindbladian = \sum_\alpha M_\alpha \rho(t) M_\alpha^\dagger \
\end{equation}
We can now choose a representation of the matrices $M_\alpha$. To best represent the results from the closed system, we choose the representation to first order as:
\begin{align}
    M_0 &= \identity + (-iH + K)dt \\
    M_\alpha &= \sqrt{dt} L_\alpha \quad \alpha \geq 0
\end{align}
Where $H, K$ are hermitian and $H, K, L_\alpha$ are independent of $dt$. Further introducing the trace preserving condition for the map, we find to first order in $dt$:
\begin{fullwidth}
\begin{align}
    \identity &= \sum_\alpha M_\alpha M_\alpha^\dagger = \left(\identity + (-iH + K)dt\right)\left(\identity + (iH + K)dt\right) + dt \sum_{\alpha \geq 1} L_\alpha L_\alpha^\dagger \\
    &= \identity + dt \left(2K +  \sum_{\alpha\geq 1} L_\alpha L_\alpha^\dagger\right) + \mathcal{O}(dt^2) 
\end{align}
\end{fullwidth}
Which only holds for:
\begin{equation}
    K = - \frac12 \sum_a L_a L_a^\dagger
\end{equation}
where $a$ is reindexing of such that $a = \alpha - 1$. Introducing this back in Eq. \ref{eq:mapping_comparison} 

\begin{fullwidth}
\begin{align}
    \rho(t) + dt \lindbladian &= \left(\identity + (-iH + K)dt\right)\rho(t)\left(\identity + (iH + K)dt\right) + dt \sum_{\alpha \geq 1} L_\alpha \rho(t) L_\alpha^\dagger \\
    &= \rho(t) + dt \left(-i H \rho(t) + iH \rho(t)\right) + dt \left(\sum_a L_a \rho(t) L_a^\dagger + K \rho(t) + \rho(t) K\right) + \mathcal{O}(dt^2) \\
    &= \rho(t) -i dt[H, \rho(t)] + dt \sum_a \left(L_a \rho(t) L_a^\dagger - \frac12 L_a L_a^\dagger \rho(t) - \frac12 \rho(t)L_a L_a^\dagger  \right) + \mathcal{O}(dt^2)
\end{align}
\end{fullwidth}

Such that we end with:
\begin{fullwidth}
\begin{equation}
    \dot{\rho}(t) = \lindbladian[\rho] = -i dt[H, \rho(t)] +  \sum_a \left(L_a \rho(t) L_a^\dagger - \frac12 L_a L_a^\dagger \rho(t) - \frac12 \rho(t)L_a L_a^\dagger  \right)
\end{equation}
\end{fullwidth}

This is the evolution in the Schrödinger picture. In the Hamiltonian picture, we would have the time depence on the operators instead of the states. Since the operators will have to turn the opposite way of the states to get the same effect, we have: \textbf{We can insert argument here:}
\begin{equation}
    \Dot{A_H} = i dt[H, \rho(t)] +  \sum_a \left(L_a \rho(t) L_a^\dagger - \frac12 L_a L_a^\dagger \rho(t) - \frac12 \rho(t)L_a L_a^\dagger  \right)
\end{equation}

\subsection{Physical Derivation}
\textbf{Might be better with an example.}
To get a better feeling for the Lindblad operators, we sketch out a physical derivation. \footnote{Just taken from wikipedia} We consider a system which interact with the environment, such that the total hamiltonian becomes:
\begin{equation}
    H = H_S + H_E + H_{ES}
\end{equation}
In the interaction picture subject to the unitary transformation by: $\rho \to \unitary_0 \rho \unitary_0^\dagger$ and operators: $H_{BS} \to \unitary^\dagger_0 \rho \unitary_0$ with $\unitary_0 = \exp(-i(H_S + H_E)t)$. The total system evolves as:
\begin{equation}\label{eq:rho_dot}
    \dot{\rho} = -i \comm{H}{\rho} 
\end{equation}
Which is solves by:
\begin{equation}
    \rho = \rho(t = 0) - i \int_0^t dt' \comm{H_0(t')}{\rho(t)}
\end{equation}
Which can be substituted into Eq. \ref{eq:rho_dot}:
\begin{equation}
    \dot{\rho} = -i \comm{H_{ES}}{\rho(0)} - i \int_0^t dt' \comm{H_{ES}(t')}{\comm{H_{ES}(t')}{\rho(t)}}
\end{equation}

\newthought{The environment should just be traced out and we should be left with the same expression to first order.}